replicaCount: 1

strategy: Recreate

image:
  repository: muehlhansfl/coflnet-bot
  tag: 8ced368d-4ac7-4ebd-84a7-2d87a1db677d
  pullPolicy: IfNotPresent

ports:
  - containerPort: 2222
    name: metrics
  - containerPort: 3000
    name: api

resources:
  requests:
    cpu: 100m
    memory: 200Mi

serivcePorts:
  - name: api
    port: 3000
    targetPort: 3000
  - name: metrics
    port: 2222
    targetPort: 2222

envVars:
  # general
  - name: PORT
    value: "3000"

  # discord vars
  - name: BOT_TOKEN
    valueFrom:
      secretKeyRef:
          name: secret
          key: coflnet_token

  - name: GUILD_ID
    value: "267680588666896385"
  - name: CHAT_WEBHOOK
    valueFrom:
      secretKeyRef:
        name: secret
        key: cofl_chat_discord_webhook
  - name: CHAT_CHANNEL_ID
    value: "965323875246276660"

  # database vars
  - name: MONGO_URI
    valueFrom:
      secretKeyRef:
        name: secret
        key: mongo_host
  - name: MIGRATION_ENABLED
    value: "false"

  - name: DATABASE_URL
    valueFrom:
      secretKeyRef:
        name: secret
        key: coflnet_database_url
  - name: REDIS_HOST
    value: "sky-global-redis.sky"
  - name: REDIS_CHAT_CHANNEL
    value: "chat"

  # external services
  - name: CHAT_URL
    value: "http://sky-chat.sky:8000/"
  - name: CHAT_API_AUTHORIZATION
    valueFrom:
      secretKeyRef:
        name: secret
        key: chat_api_key
  - name: PROXY_URL
    value: "http://sky-proxy.sky:8000/"
  - name: MC_CONNECT_URL
    value: "http://sky-mc-connect.sky:8000/"
  - name: PAYMENT_URL
    value: "http://payments.payment:8000/"

  # tracing
  - name: OTEL_SERVICE_NAME
    value: "coflnet-bot"
  - name: OTEL_EXPORTER_OTLP_TRACES_ENDPOINT
    value: "http://jaeger-collector.observability:4317"
  - name: OTEL_TRACES_EXPORTER
    value: jaeger
