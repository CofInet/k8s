imagePullSecrets:
  - name: harbor

payments:
  name: payments
  replicaCount: 2
  maxUnavailable: 1
  image:
    repository: harbor.flou.dev/coflnet/payments
    tag: 4eda29eb-d150-4112-893c-3f9cc1e2a240
  ports:
    - name: api
      containerPort: 8000
  
  serivcePorts:
    - name: api
      port: 8000
      targetPort: 8000
  
  readinessProbe:
    httpGet:
      path: /api/index.html
      port: api
    initialDelaySeconds: 20
    periodSeconds: 3

  resources: 
    requests:
      cpu: 500m
      memory: 1Gi
    limits: 
      cpu: 1000m
      memory: 2Gi

  envVars:
    - name: JAEGER_AGENT_HOST
      valueFrom:
        fieldRef:
          fieldPath: status.hostIP

    - name: OTEL_EXPORTER_JAEGER_AGENT_HOST
      valueFrom:
        fieldRef:
          fieldPath: status.hostIP
  
    - name: STRIPE__ID
      valueFrom:
        secretKeyRef: 
          name: secret
          key: stripe_secret

    - name: STRIPE__KEY
      valueFrom:
        secretKeyRef:
          name: secret
          key: stripe_key
  
    - name: STRIPE__SIGNING_SECRET
      valueFrom:
        secretKeyRef: 
          name: secret
          key: stripe_signing_secret
  
    - name: PAYPAL__ID
      valueFrom:
        secretKeyRef: 
          name: secret
          key: paypal_id

    - name: PAYPAL__SECRET
      valueFrom:
        secretKeyRef: 
          name: secret
          key: paypal_secret

    - name: PAYPAL__IS_SANDBOX
      value: "false"
  
    - name: KAFKA_HOST
      value: k8-main-kafka-kafka.kafka.svc.cluster.local

    - name: DB_CONNECTION
      valueFrom:
        secretKeyRef:
          name: secret
          key: connection_string_payment

ingress:
  hosts:
  - host: sky.coflnet.com
    http:
      paths:
      - path: /callback/stripe
        pathType: ImplementationSpecific
        backend:
          service: 
            name: payments
            port:
              number: 8000
      - path: /callback/paypal
        pathType: ImplementationSpecific
        backend:
          service: 
            name: payments
            port:
              number: 8000
  - host: skyblock-backend.coflnet.com
    http:
      paths:
      - path: /callback/stripe
        pathType: ImplementationSpecific
        backend:
          service:
            name: payments
            port:
              number: 8000
      - path: /callback/paypal
        pathType: ImplementationSpecific
        backend:
          service: 
            name: payments
            port:
              number: 8000



